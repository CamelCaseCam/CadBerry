<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<title>RNAstructure GUI Help -- Multilign</title>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
		<link href="Stylesheet.css" rel="stylesheet" type="text/css">
	</head>
	<body>
		<div class="bodydiv">
			<table cellpadding="0" cellspacing="0" border="0" class="mainTable">
				<tr class="headerRow">
					<td class="headerBox"><img src="../images/icon.jpg" alt="RNAstructure logo"></td>
					<td class="headerLabel"><h2>RNAstructure GUI Help<br>Multilign</h2></td>
					<td class="headerBox2">
						<ul id="navigator">
							<li><h3 class="noMarginOrPad"><a href="Contents.html">Contents</a></h3></li>
							<li><h3 class="noMarginOrPad"><a href="Index.html">Index</a></h3></li>
						</ul>
					</td>
				</tr>
				<tr>
					<td class="mainContent" colspan="3">
						<div>
							<p>Multilign is a tool that will find the lowest free energy secondary structure common to multiple (more than two) unaligned sequences and the sequence alignment that reflects the conserved structure. The input is more than two sequences. The output is an equivalent number of structures (saved as <a href="Appendix_of_File_Formats.html">CT files</a>) and an alignment saved as plain text.</p>
							<p>Multilign uses the mutual information of the sequences to constrain secondary structure prediction. This information is applied in a progressive, iterative fashion, using <a href="Dynalign.html">Dynalign</a>, to continually improve prediction. This can result in a large improvement in the accuracy of secondary structure prediction. The algorithm generates an alignment of the sequences, but does not depend on sequence identity. See &quot;<a href="References.html">References</a>&quot; for more details.</p>
							<p>Multilign can predict a set of low energy structures and alignments, called suboptimal structures. A set of parameters (explained below) are used to define how many suboptimal structures to generate and how different from each other the suboptimal structures should be.</p>
							<hr>
						</div>

						<p><b>To predict the common structures and alignment with Multilign</b></p>
						<ol>
							<li>Click the button labeled &quot;Sequence File&quot; and provide the name of a sequence file.</li>
							<li>A default name has been entered for the CT File. If desired, this name can be changed by clicking the corresponding button.</li>
							<li>Click the &quot;ADD&quot; button to add the sequence and CT files to the sequence set under consideration. Note that at least three sequences must be added for Multilign to run correctly.</li>
							<li>Continue adding sequence and CT files to the sequence set in this manner until all desired input and output files have been specified.</li>
							<li>If a sequence/CT pair was entered in error, it can be removed by clicking the &quot;Delete Sequence&quot; button. The number of the sequence to be removed can be found in the text box next to the button, and it is by default the last sequence. However, specific sequence/CT pairs can be deleted by changing this value. Only one sequence can be deleted at a time.</li>
							<li>After the first sequence/CT pair has been added to the sequence set, a default file name for the multiple alignment file is given. To change this name, click the &quot;Alignment File&quot; button.</li>
							<li>Choose whether single base pair inserts will be allowed into a single structure by checking or unchecking the box.</li>
							<li>Choose whether pairwise Dynalign save files and alignments will be generated by clicking the box. These files will be generated in the same directory as the CT file associated with the index sequence (see below). So, for example, if the index sequence is the third one (3), the intermediate files will be generated in the same directory as the CT file for sequence 3. (Note that on Windows, the files must be generated.)</li>
							<li>Default parameters have also been entered for suboptimal structure generation. These can be modified at this time. An explanation of these parameters can be found below.</li>
							<li>The Multilign-specific Max Pairs parameter is variable, and changes depending on the number and content of sequences given. If a specific value should be used, that value should be input into the box <b>after</b> all sequence/CT pairs have been added.</li>
							<li>Click &quot;Start&quot; to begin the Multilign algorithm. This calculation may take some time. A progress bar opens to indicate the approximate progress of the calculation.</li>
							<li>When complete, windows will open to display the structures predicted for each sequence. The alignment file is plain text and can be viewed with any text editor, such as Wordpad, TextEdit, or Emacs. </li>
						</ol>
						<hr>

						<p><b>Parameters controlling the prediction of suboptimal structures</b></p>
						<dl>
							<dt>Max % Energy Difference</dt>
							<dd>The maximum percent change in energy between the lowest free energy structure and the most suboptimal structure. Increasing this percentage can increase the number of structures generated.</dd>

							<dt>Max Number of Structures</dt>
							<dd>An absolute limit on the number of generated suboptimal structures.</dd>

							<dt>
								Window Sizes<br>
								Note that larger windows require that the suboptimal structures be relatively more different from each other.<br><br>
							</dt>
							<dd>
								<dl>
									<dt>Structure Window Size</dt>
									<dd>In each suboptimal structure, there must be at least one new base pair that is separated from all base pairs in other suboptimal structures by <i>window</i> nucleotides. Once a base pair is formed between nucleotides <i>i</i> and <i>j</i> in a suboptimal structure, the square region of base pairs from <i>i</i>-<i>window</i> to <i>i</i>+<i>window</i> paired to <i>j</i>-<i>window</i> to <i>j</i>+<i>window</i> is marked as represented. Subsequent suboptimal structures must have at least one pair outside of the marked region.</dd>

									<dt>Alignment Window Size</dt>
									<dd>The alignment window requires that each suboptimal alignment be different from other alignments by having two aligned nucleotides at least <i>window</i> nucleotides from other alignments. The smaller the windows (to the minimum value of zero) the more suboptimal structures that can be generated and the more similar the suboptimal structures are to each other.</dd>
								</dl>
							</dd>

							<dt>Iterations</dt>
							<dd>The number of iterations for the calculation to go through.</dd>

							<dt>Max Pairs</dt>
							<dd>The maximum number of pairs allowed in structures.</dd>

							<dt>Max DSV Change</dt>
							<dd>The maximum percent change allowed during progressive comparisons.</dd>
						</dl>
					</td>
				</tr>
				<tr>
					<td class="footer" colspan="3">
						<p>Visit <a href="http://rna.urmc.rochester.edu/RNAstructure.html">The Mathews Lab RNAstructure Page</a> for updates and latest information.</p>
					</td>
				</tr>
			</table>
		</div>
	</body>
</html>
